<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Research Portfolio | Soil • Water • Energy</title>
  
  <!-- Fonts -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  
  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    :root {
      --bg-color: #020617;
      --text-color: #f8fafc;
      --text-muted: #94a3b8;
      
      /* Theme Colors */
      --soil-color: #10b981;   /* Emerald Green */
      --water-color: #0ea5e9;  /* Sky Blue */
      --energy-color: #f59e0b; /* Amber/Orange */
      --ai-color: #8b5cf6;     /* Violet for AI */
      
      --card-bg: rgba(30, 41, 59, 0.4);
      --glass-border: 1px solid rgba(255, 255, 255, 0.08);
      --font-display: "Space Grotesk", sans-serif;
      --font-body: "Inter", sans-serif;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background-color: var(--bg-color);
      color: var(--text-color);
      font-family: var(--font-body);
      line-height: 1.6;
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
    }

    /* --- Top Exclusive Bar --- */
    .exclusive-bar {
      background: linear-gradient(90deg, #0f172a, #1e293b, #0f172a);
      color: var(--text-muted);
      font-family: var(--font-display);
      text-align: center;
      padding: 0.5rem;
      font-size: 0.75rem;
      letter-spacing: 3px;
      text-transform: uppercase;
      border-bottom: var(--glass-border);
      position: relative;
      z-index: 101;
    }
    .exclusive-bar span {
      background: linear-gradient(to right, var(--soil-color), var(--water-color), var(--energy-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: 700;
    }

    /* --- Scroll Progress --- */
    .scroll-progress {
      position: fixed; top: 0; left: 0; width: 0%; height: 2px;
      background: linear-gradient(90deg, var(--soil-color), var(--water-color), var(--energy-color));
      z-index: 1002;
      transition: width 0.1s;
    }

    /* --- Background & Parallax --- */
    .parallax-bg {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      z-index: -1;
      background: radial-gradient(circle at 50% 50%, #0f172a 0%, #020617 100%);
      overflow: hidden;
    }

    .orb {
      position: absolute;
      border-radius: 50%;
      filter: blur(120px);
      opacity: 0.25;
      animation: float 25s infinite ease-in-out;
    }

    .orb-1 { width: 600px; height: 600px; background: var(--soil-color); top: -20%; left: -10%; animation-delay: 0s; }
    .orb-2 { width: 500px; height: 500px; background: var(--water-color); top: 30%; right: -10%; animation-delay: -5s; }
    .orb-3 { width: 550px; height: 550px; background: var(--energy-color); bottom: -20%; left: 20%; animation-delay: -10s; }

    @keyframes float {
      0%, 100% { transform: translate(0, 0); }
      50% { transform: translate(40px, 60px); }
    }

    /* Grid Overlay */
    .grid-overlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background-image: 
        linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
      background-size: 60px 60px;
      z-index: -1;
      mask-image: radial-gradient(circle at center, black 30%, transparent 80%);
    }

    /* --- Navigation --- */
    nav {
      position: sticky; top: 0; width: 100%; z-index: 100;
      padding: 1rem 2rem;
      display: flex; justify-content: space-between; align-items: center;
      backdrop-filter: blur(16px);
      border-bottom: var(--glass-border);
      background: rgba(2, 6, 23, 0.7);
    }

    .logo {
      font-family: var(--font-display);
      font-weight: 700;
      font-size: 1.2rem;
      color: white;
      text-decoration: none;
      letter-spacing: 2px;
      display: flex; align-items: center; gap: 0.5rem;
    }

    .nav-links { display: flex; gap: 2rem; }

    .nav-link {
      color: var(--text-muted);
      text-decoration: none;
      font-size: 0.9rem;
      transition: color 0.3s;
      position: relative;
      font-family: var(--font-display);
    }
    .nav-link:hover { color: white; }

    .menu-toggle { display: none; background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; }

    /* --- Hero Section --- */
    .hero {
      min-height: 85vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 6rem 2rem;
      position: relative;
    }

    .hero h1 {
      font-family: var(--font-display);
      font-size: clamp(3.5rem, 9vw, 6rem);
      font-weight: 800;
      line-height: 1.1;
      margin-bottom: 1.5rem;
      color: white;
      animation: fadeInUp 0.8s ease-out;
    }
    
    .hero h1 span {
      background: linear-gradient(to right, #fff, #94a3b8);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .hero p {
      font-size: clamp(1.1rem, 2vw, 1.25rem);
      color: var(--text-muted);
      max-width: 700px;
      margin-bottom: 3rem;
      animation: fadeInUp 0.8s ease-out 0.2s backwards;
      line-height: 1.7;
    }

    /* AI Search Bar in Hero */
    .hero-search-wrapper {
        position: relative;
        width: 100%;
        max-width: 600px;
        margin-bottom: 2.5rem;
        animation: fadeInUp 0.8s ease-out 0.3s backwards;
        z-index: 10;
    }

    .hero-search-input {
        width: 100%;
        padding: 1.2rem 3.5rem 1.2rem 1.5rem;
        border-radius: 50px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: white;
        font-family: var(--font-body);
        font-size: 1.1rem;
        backdrop-filter: blur(12px);
        transition: all 0.3s ease;
        box-shadow: 0 4px 20px rgba(0,0,0,0.2);
    }

    .hero-search-input:focus {
        background: rgba(255, 255, 255, 0.1);
        border-color: var(--ai-color);
        box-shadow: 0 0 0 4px rgba(139, 92, 246, 0.15), 0 10px 30px rgba(0,0,0,0.3);
        outline: none;
    }

    .hero-search-btn {
        position: absolute;
        right: 8px;
        top: 50%;
        transform: translateY(-50%);
        width: 45px;
        height: 45px;
        border-radius: 50%;
        border: none;
        background: linear-gradient(135deg, #8b5cf6, #d946ef);
        color: white;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 1.2rem;
        transition: all 0.3s ease;
        box-shadow: 0 0 15px rgba(139, 92, 246, 0.4);
    }

    .hero-search-btn:hover {
        transform: translateY(-50%) scale(1.1);
        box-shadow: 0 0 25px rgba(139, 92, 246, 0.6);
    }

    .hero-search-btn i {
        animation: sparkle 2s infinite alternate;
    }

    .hero-btns {
      display: flex; gap: 1rem;
      animation: fadeInUp 0.8s ease-out 0.4s backwards;
    }

    .btn {
      padding: 1rem 2.5rem; border-radius: 50px;
      text-decoration: none; font-weight: 600; font-family: var(--font-display);
      transition: all 0.3s; border: 1px solid transparent;
      text-transform: uppercase; letter-spacing: 1px; font-size: 0.8rem;
    }
    .btn-primary {
      background: white; color: #020617;
    }
    .btn-primary:hover { background: #e2e8f0; transform: translateY(-3px); box-shadow: 0 10px 30px rgba(255,255,255,0.15); }
    
    .btn-outline {
      border-color: rgba(255,255,255,0.2); color: white; background: rgba(255,255,255,0.02);
    }
    .btn-outline:hover { border-color: white; background: rgba(255,255,255,0.08); }

    .scroll-indicator {
      position: absolute; bottom: 3rem;
      animation: bounce 2s infinite;
      color: var(--text-muted);
      font-size: 1.2rem; opacity: 0.7;
    }

    /* --- Projects Section --- */
    .projects-section {
      padding: 4rem 2rem 8rem;
      max-width: 1300px;
      margin: 0 auto;
    }

    .section-header {
      text-align: center; margin-bottom: 5rem;
    }
    .section-header h2 {
      font-family: var(--font-display); font-size: 2.5rem; margin-bottom: 1rem; color: white;
    }
    .section-header p { color: var(--text-muted); max-width: 500px; margin: 0 auto; }

    .grid-3 {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 3rem;
    }

    /* 3D Card Styles */
    .card-wrapper { perspective: 1500px; }

    .project-card {
      background: var(--card-bg);
      backdrop-filter: blur(24px);
      border: var(--glass-border);
      border-radius: 24px;
      padding: 3rem 2rem;
      text-decoration: none;
      color: white;
      position: relative;
      overflow: hidden;
      transition: transform 0.5s cubic-bezier(0.23, 1, 0.32, 1), box-shadow 0.5s;
      display: flex;
      flex-direction: column;
      height: 100%;
      animation: fadeInUp 0.8s ease-out backwards;
    }

    /* Hover Interaction */
    .card-wrapper:hover .project-card {
      transform: translateY(-15px) rotateX(5deg);
    }

    .project-card::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px;
      background: linear-gradient(90deg, transparent, currentColor, transparent);
      opacity: 0; transition: opacity 0.3s;
    }
    .project-card:hover::before { opacity: 1; }

    /* Theme-Specific Shadows & Colors */
    .project-card[data-theme="soil"] { color: var(--soil-color); }
    .project-card[data-theme="soil"]:hover { box-shadow: 0 25px 50px -12px rgba(16, 185, 129, 0.2); }
    
    .project-card[data-theme="water"] { color: var(--water-color); }
    .project-card[data-theme="water"]:hover { box-shadow: 0 25px 50px -12px rgba(14, 165, 233, 0.2); }
    
    .project-card[data-theme="energy"] { color: var(--energy-color); }
    .project-card[data-theme="energy"]:hover { box-shadow: 0 25px 50px -12px rgba(245, 158, 11, 0.2); }

    /* Inner Card Content */
    .card-icon {
      font-size: 3.5rem; margin-bottom: 2rem;
      transition: transform 0.5s ease;
      filter: drop-shadow(0 0 10px currentColor);
    }
    .project-card:hover .card-icon { transform: scale(1.1) translateZ(30px); }

    .card-title {
      font-family: var(--font-display); font-size: 1.75rem; margin-bottom: 1rem; color: white; font-weight: 700;
    }

    .tags {
      display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 2rem;
    }
    .tag {
      font-size: 0.7rem; padding: 0.3rem 0.8rem; border-radius: 50px;
      background: rgba(255,255,255,0.03); color: var(--text-muted);
      border: 1px solid rgba(255,255,255,0.1); text-transform: uppercase; letter-spacing: 1px;
    }

    .card-desc {
      font-size: 1rem; color: var(--text-muted); margin-bottom: 3rem; flex-grow: 1; line-height: 1.7;
    }

    .card-link {
      font-family: var(--font-display); font-weight: 700; display: flex; align-items: center; gap: 0.75rem;
      margin-top: auto; transition: gap 0.3s; text-transform: uppercase; letter-spacing: 1px; font-size: 0.85rem;
    }
    .project-card:hover .card-link { gap: 1.2rem; }

    /* --- Interactive Map Section --- */
    .map-section {
      padding: 6rem 2rem;
      background: rgba(15, 23, 42, 0.3);
      border-top: var(--glass-border);
      border-bottom: var(--glass-border);
    }

    .map-container {
      display: grid;
      grid-template-columns: 1.2fr 0.8fr;
      gap: 3rem;
      max-width: 1200px;
      margin: 0 auto;
      align-items: center;
    }

    @media (max-width: 900px) {
      .map-container { grid-template-columns: 1fr; }
    }

    .map-visual {
      position: relative;
      width: 100%;
      height: 600px;
      background: rgba(255,255,255,0.02);
      border-radius: 24px;
      border: var(--glass-border);
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    /* SVG Map Styling - UPDATED FOR HIGH VISIBILITY */
    .region {
      cursor: pointer;
      transition: all 0.3s ease;
      stroke: rgba(255, 255, 255, 0.6); /* Brighter stroke */
      stroke-width: 1.5px;
      fill: rgba(255, 255, 255, 0.15); /* Lighter fill to stand out from bg */
    }

    .region:hover, .region.active {
      filter: drop-shadow(0 0 15px currentColor);
      transform: scale(1.01);
      z-index: 10;
      stroke: white;
      stroke-width: 2.5px;
      fill-opacity: 1; 
    }

    /* Division Specific Colors - High Saturation */
    #division-dhaka:hover, #division-dhaka.active { fill: #10b981; color: #10b981; } /* Green */
    #division-chittagong:hover, #division-chittagong.active { fill: #f59e0b; color: #f59e0b; } /* Orange */
    #division-sylhet:hover, #division-sylhet.active { fill: #0ea5e9; color: #0ea5e9; } /* Blue */
    #division-khulna:hover, #division-khulna.active { fill: #0ea5e9; color: #0ea5e9; } /* Blue */
    #division-barishal:hover, #division-barishal.active { fill: #0ea5e9; color: #0ea5e9; } /* Blue */
    #division-rajshahi:hover, #division-rajshahi.active { fill: #f59e0b; color: #f59e0b; } /* Orange */
    #division-rangpur:hover, #division-rangpur.active { fill: #10b981; color: #10b981; } /* Green */

    /* Tooltip */
    .map-tooltip {
      position: fixed;
      background: rgba(15, 23, 42, 0.95);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255,255,255,0.2);
      padding: 1rem 1.5rem;
      border-radius: 12px;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.2s, transform 0.1s;
      z-index: 1000;
      transform: translate(-50%, -120%);
      text-align: center;
      box-shadow: 0 10px 30px -5px rgba(0,0,0,0.8);
      min-width: 150px;
    }
    .map-tooltip h4 {
      margin: 0 0 0.25rem 0;
      font-size: 1.1rem;
      font-family: var(--font-display);
      color: white;
    }
    .map-tooltip p {
      margin: 0;
      font-size: 0.85rem;
      color: var(--text-muted);
      font-weight: 500;
    }

    /* Data Panel */
    .data-panel {
      background: var(--card-bg);
      backdrop-filter: blur(16px);
      border: var(--glass-border);
      border-radius: 20px;
      padding: 2.5rem;
      min-height: 300px;
      transition: all 0.3s;
    }

    .panel-header {
      font-family: var(--font-display);
      font-size: 2rem;
      margin-bottom: 0.5rem;
      color: white;
      font-weight: 700;
    }

    .panel-sub {
      color: var(--text-muted);
      font-size: 0.9rem;
      margin-bottom: 2rem;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .stat-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid rgba(255,255,255,0.05);
    }

    .stat-label { color: var(--text-muted); font-size: 0.9rem; }
    .stat-val { font-weight: 600; color: white; font-family: var(--font-display); }

    .indicator-dot {
      display: inline-block; width: 10px; height: 10px; border-radius: 50%; margin-right: 8px;
    }

    /* --- Magical AI Styles --- */
    
    /* Removed FAB - Moved to Hero */

    @keyframes pulse-glow {
      0% { box-shadow: 0 0 0 0 rgba(139, 92, 246, 0.7); }
      70% { box-shadow: 0 0 0 15px rgba(139, 92, 246, 0); }
      100% { box-shadow: 0 0 0 0 rgba(139, 92, 246, 0); }
    }

    @keyframes sparkle {
      0% { opacity: 0.8; transform: scale(0.9); }
      100% { opacity: 1; transform: scale(1.1); text-shadow: 0 0 10px white; }
    }

    .ai-chat-modal {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      width: 380px;
      height: 550px;
      background: rgba(15, 23, 42, 0.95);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      display: flex;
      flex-direction: column;
      z-index: 9999;
      transform-origin: bottom right;
      transform: scale(0);
      opacity: 0;
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      overflow: hidden;
      box-shadow: 0 20px 50px rgba(0,0,0,0.5);
    }

    .ai-chat-modal.open {
      transform: scale(1);
      opacity: 1;
    }

    .chat-header {
      padding: 1rem;
      background: linear-gradient(90deg, rgba(139, 92, 246, 0.2), rgba(217, 70, 239, 0.2));
      border-bottom: 1px solid rgba(255,255,255,0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .chat-header h3 {
      margin: 0;
      font-family: var(--font-display);
      font-size: 1rem;
      color: white;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .chat-body {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    /* Scrollbar for chat */
    .chat-body::-webkit-scrollbar { width: 5px; }
    .chat-body::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 10px; }

    .message {
      max-width: 85%;
      padding: 0.75rem 1rem;
      border-radius: 15px;
      font-size: 0.9rem;
      line-height: 1.5;
    }

    .message.ai {
      align-self: flex-start;
      background: rgba(255, 255, 255, 0.1);
      border-bottom-left-radius: 2px;
      color: #e2e8f0;
    }

    .message.user {
      align-self: flex-end;
      background: linear-gradient(135deg, #8b5cf6, #7c3aed);
      border-bottom-right-radius: 2px;
      color: white;
    }

    .suggestions {
      display: flex;
      gap: 0.5rem;
      overflow-x: auto;
      padding: 0.5rem 1rem;
      border-top: 1px solid rgba(255,255,255,0.05);
    }
    
    .suggestions::-webkit-scrollbar { height: 0; }

    .suggestion-chip {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      padding: 0.4rem 0.8rem;
      border-radius: 50px;
      font-size: 0.75rem;
      color: var(--text-muted);
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.2s;
    }

    .suggestion-chip:hover {
      background: rgba(255,255,255,0.1);
      color: white;
      border-color: rgba(255,255,255,0.3);
    }

    .chat-input-area {
      padding: 1rem;
      border-top: 1px solid rgba(255,255,255,0.1);
      display: flex;
      gap: 0.5rem;
    }

    .chat-input {
      flex: 1;
      background: rgba(0,0,0,0.3);
      border: 1px solid rgba(255,255,255,0.1);
      padding: 0.6rem 1rem;
      border-radius: 50px;
      color: white;
      font-family: var(--font-body);
      outline: none;
      transition: border-color 0.3s;
    }

    .chat-input:focus {
      border-color: #8b5cf6;
    }

    .send-btn {
      background: #8b5cf6;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.3s;
    }

    .send-btn:hover { background: #7c3aed; }
    
    .typing-indicator {
      display: flex; gap: 4px; padding: 5px 0;
    }
    .typing-dot {
      width: 6px; height: 6px; background: rgba(255,255,255,0.5); border-radius: 50%;
      animation: bounce-dot 1.4s infinite ease-in-out both;
    }
    .typing-dot:nth-child(1) { animation-delay: -0.32s; }
    .typing-dot:nth-child(2) { animation-delay: -0.16s; }
    
    @keyframes bounce-dot {
      0%, 80%, 100% { transform: scale(0); }
      40% { transform: scale(1); }
    }

    /* Animations */
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(40px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
      40% { transform: translateY(-10px); }
      60% { transform: translateY(-5px); }
    }

    /* Footer */
    footer {
      text-align: center; padding: 4rem 2rem; border-top: var(--glass-border);
      background: rgba(2, 6, 23, 0.8); backdrop-filter: blur(10px);
    }
    
    .visitor-count {
      margin-top: 1rem;
      font-size: 0.8rem;
      color: var(--text-muted);
      font-family: var(--font-display);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .nav-links { display: none; position: absolute; top: 100%; left: 0; width: 100%; background: #0f172a; flex-direction: column; padding: 2rem; border-bottom: var(--glass-border); }
      .nav-links.active { display: flex; }
      .menu-toggle { display: block; }
      h1 { font-size: 3rem; }
      .hero { padding-top: 4rem; }
      .ai-chat-modal {
        width: 90%;
        right: 5%;
        bottom: 2rem;
        height: 60vh;
      }
    }
  </style>
</head>
<body>

  <div class="scroll-progress"></div>

  <!-- Tooltip -->
  <div id="map-tooltip" class="map-tooltip">
    <h4>Division</h4>
    <p>Details</p>
  </div>

  <!-- Exclusive Bar -->
  <div class="exclusive-bar">
    [ <span>A RAZIN SALEH EXCLUSIVE</span> ]
  </div>

  <!-- Background Layers -->
  <div class="parallax-bg">
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>
    <div class="grid-overlay"></div>
  </div>

  <!-- Navigation -->
  <nav>
    <a href="#" class="logo">
      <i class="fa-solid fa-layer-group"></i> NEXUS
    </a>
    <div class="nav-links">
      <a href="#projects" class="nav-link">Projects</a>
      <a href="#map" class="nav-link">Regional Impact</a>
      <a href="#" class="nav-link">Contact</a>
    </div>
    <button class="menu-toggle"><i class="fa-solid fa-bars"></i></button>
  </nav>

  <!-- Hero Section -->
  <section class="hero">
    <h1>Engineering the <br><span>Future of Resilience</span></h1>
    <p>A multidisciplinary research portfolio exploring advanced technical frameworks in sustainable agriculture, autonomous water restoration, and renewable energy systems for the Ganges Delta.</p>
    
    <!-- AI Search Bar in Landing -->
    <div class="hero-search-wrapper">
        <input type="text" class="hero-search-input" id="hero-input" placeholder="Ask Nexus AI: 'What is Project WATER?'" onkeypress="handleHeroEnter(event)">
        <button class="hero-search-btn" onclick="sendHeroMessage()">
            <i class="fa-solid fa-wand-magic-sparkles"></i>
        </button>
    </div>

    <div class="hero-btns">
      <a href="#projects" class="btn btn-primary">View Research</a>
      <a href="#map" class="btn btn-outline">Regional Data</a>
    </div>
    <div class="scroll-indicator">
      <i class="fa-solid fa-angles-down"></i>
    </div>
  </section>

  <!-- Projects Grid -->
  <div id="projects" class="projects-section">
    <div class="section-header">
      <h2>Selected Works</h2>
      <p>Three pillars of sustainable development engineered for impact.</p>
    </div>

    <div class="grid-3">
      
      <!-- SOIL CARD -->
      <div class="card-wrapper" style="animation-delay: 0.1s;">
        <a href="https://radiantrider38.github.io/agri/" class="project-card" data-theme="soil" target="_blank">
          <div class="card-icon"><i class="fa-solid fa-seedling"></i></div>
          <h3 class="card-title">Smart Agriculture</h3>
          <div class="tags">
            <span class="tag">IoT Network</span>
            <span class="tag">Robotics</span>
            <span class="tag">AI</span>
          </div>
          <p class="card-desc">
            A precision farming ecosystem integrating real-time soil chemical sensing, automated pest control, and predictive micro-climate modeling to maximize crop yield.
          </p>
          <div class="card-link">
            View Thesis <i class="fa-solid fa-arrow-right-long"></i>
          </div>
        </a>
      </div>

      <!-- WATER CARD -->
      <div class="card-wrapper" style="animation-delay: 0.2s;">
        <a href="https://radiantrider38.github.io/water/" class="project-card" data-theme="water" target="_blank">
          <div class="card-icon"><i class="fa-solid fa-droplet"></i></div>
          <h3 class="card-title">Project W.A.T.E.R.</h3>
          <div class="tags">
            <span class="tag">Restoration</span>
            <span class="tag">Autonomous</span>
            <span class="tag">Circular</span>
          </div>
          <p class="card-desc">
            A theoretical framework utilizing autonomous bubble barriers to intercept transboundary pollution and upcycle river waste into clean energy and materials.
          </p>
          <div class="card-link">
            View Thesis <i class="fa-solid fa-arrow-right-long"></i>
          </div>
        </a>
      </div>

      <!-- ENERGY CARD -->
      <div class="card-wrapper" style="animation-delay: 0.3s;">
        <a href="https://radiantrider38.github.io/energy/" class="project-card" data-theme="energy" target="_blank">
          <div class="card-icon"><i class="fa-solid fa-bolt"></i></div>
          <h3 class="card-title">HAYTHAM X ONE</h3>
          <div class="tags">
            <span class="tag">CSP</span>
            <span class="tag">Hydrogen</span>
            <span class="tag">Thermal</span>
          </div>
          <p class="card-desc">
            A reliable energy nexus combining Concentrating Solar Power (CSP) with thermal sand storage and hydrogen fuel cells for continuous grid electricity.
          </p>
          <div class="card-link">
            View Thesis <i class="fa-solid fa-arrow-right-long"></i>
          </div>
        </a>
      </div>

    </div>
  </div>

  <!-- Regional Map Visualization -->
  <section id="map" class="map-section">
    <div class="section-header" style="margin-bottom: 3rem;">
      <h2>Regional Data Graph</h2>
      <p>Interactive impact analysis across Bangladesh's administrative divisions.</p>
    </div>

    <div class="map-container">
      <!-- Stylized Map with UPDATED VISIBILITY -->
      <div class="map-visual" id="mapVisual">
        <svg xml:space="preserve" enable-background="new 0 0 435 600" viewBox="0 0 435 600" height="100%" width="100%" y="0px" x="0px" xmlns="http://www.w3.org/2000/svg" id="country-bangladesh" version="1.1">
          <!-- Dhaka -->
          <path class="region" id="division-dhaka" onmouseenter="updateMap('Dhaka')" onmouseleave="hideTooltip()" d="M180.286,101.943c-0.105,2.158-2.341,17.521,0.83,18.306c10.762,2.667,10.35,5.256,10.742,12.013c1.583,0.938,2.844,0.848,4.679,1.072c3.305,2.293-4.025,3.261-1.685,6.644c1.961,2.833-0.523,7.805-1.354,9.29c1.556,0.715,4.087,0.222,4.444,2.308c0.212,1.241-2.829,6.069-5.204,9.041c-15.791,6.453-6.436,12.478-15.275,23.543c-3.595,3.902-2.933,3.189-7.678,4.238c-4.118,0.911-7.208,4.576-7.933,8.251c-1.162,5.876-0.778,15.41-0.479,15.239c-8.287,4.739-9.936,13.847-1.432,20.95c-1.083,2.517-7.618,6.078-7.435,8.036c-1.411,0.199-15.296-2.004-15.577,1.078c-0.299,0.53-0.701,1.493-0.701,1.493s3.76,3.647,1.873,4.912c-1.922,1.286-4.169-7.056-3.144-9.481c-3.266,0.56-15.264,10.967-18.584,16.512c-5.271-3.011-12.043-10.076-13.782-15.677c0-1.601,4.751-0.326,4.426-3.85c0.146,1.585-7.343-3.597-7.228-4.774c0.122-1.236,1-1.31,1.816-1.97c-1.442,1.164-6.762-6.781-3.575-7.847c6.107-2.035-6.963-8.924-6.319-6.989c-4.719-12.004-15.734-16.474-7.405-27.335c4.921,8.786,21.081,11.594,25.659,7.226c2.934-2.087-4.352-11.403-4.509-11.71c-2.116-4.145,4.553-4.774,5.288-13.1c0.807-9.135-4.286-16.097-2.212-21.338c1.421-3.588,5.531-15.749,3.733-19.409c-1.126-2.289-5.023-1.212-7.025-4.122c-1.51-2.197-1.575-6.473-1.569-10.51c0.005-3.525-0.128-7.092,0.028-8.711c0.336-3.472,8.535-2.837,8.021-9.461c-0.318-4.088-1.806-7.359,1.058-7.324C112.677,104.131,167.9,105.66,180.286,101.943z"></path>
          
          <!-- Chittagong -->
          <path class="region" id="division-chittagong" onmouseenter="updateMap('Chittagong')" onmouseleave="hideTooltip()" d="M183.375,313.922c0.007,0.008,0.022-0.027,0.044-0.094C183.372,313.86,183.348,313.893,183.375,313.922z M189.088,289.404c-3.299,0-3.706,18.468-3.783,18.252C192.472,301.528,202.369,289.404,189.088,289.404z M183.419,313.828c0.579-0.398,6.298-0.993,6.286-1.183C185.619,305.029,183.736,312.871,183.419,313.828z M184.378,285.77c0.162,0.69,0.353,4.201,0.927,4.602C186.456,291.173,188.008,283.96,184.378,285.77z M182.563,280.975c-1.51-1.284-3.328-5.999-7.914-3.752C174.649,278.656,181.556,282.433,182.563,280.975z M181.212,284.803c-1.155,0.253,0.453,5.916,1.93,5.916C183.142,290.719,184.301,284.123,181.212,284.803z M184.185,294.47c-0.734-2.598-7.027,13.265-5.675,15.469C181.512,303.845,185.349,298.586,184.185,294.47z M156.708,246.635c3.296,0,4.767-0.474,3.591-4.834C157.346,240.009,156.17,244.476,156.708,246.635z M202.177,281.979c7.205,1.028,5.285-5.771,4.247-7.115C204.285,274.804,201.6,279.669,202.177,281.979z M218.47,288.205c1.781-2.338-0.146-6.398-1.775-8.197C205.935,268.395,214.437,293.497,218.47,288.205z M283.941,352.213c0.304-4.854-1.713-11.725-0.988-17.381c1.449-11.302-1.156-23.466-2.399-28.747c0,0,2.062-0.143,1.458-13.301c-0.386-8.417-9.288-27.245-6.961-33.871c0.362-1.034-5.431-17.11-5.384-17.055c-3.493-4.074,0.195-13.236,0.195-17.811c0-2.147-6.808-25.107-6.742-25.093c-1.178,1.411-2.208,2.924-3.089,4.543c-0.566,0.047-1.479-4.871-2.799-5.376c-3.316-1.269-4.232,5.538-6.814,5.917c-2.937,0.431-4.589-4.104-5.984-5.588c3.704,3.938-4.261,18.308-6.775,21.486c-5.755,7.272-4.737,18.061-4.725,25.054c0.004,2.646-10.793,5.941-10.894,5.336c-0.141-0.854-4.622-7.098-5.629-9.401c-1.38-3.157-3.403-13.826-8.366-9.006c-0.707,0.968,1.567,12.965,0.907,12.762c-4.372-1.342-8.36-19.598-4.98-21.288c0-2.282-7.787-14.183-9.529-18.422c-0.036,0.121-0.071,0.065-0.104-0.256c0.03,0.08,0.068,0.169,0.104,0.256c0.204-0.685,0.417-7.252,0.002-6.369c-0.029,0.084-0.063,0.168-0.086,0.254c0.031-0.12,0.06-0.198,0.086-0.254c0.827-2.384,4.277-4.518,5.782-7.46c-0.525-4.786,1.458-3.307,1.364-7.36c-3.345-2.394-2.681-15.906-1.332-17.265c-2.646,2.667-3.587,0.827-7.053-2.442c-14.473,5.947-2.912,8.998-13.777,22.601c-5.831,6.328-13.937,0.908-15.27,14.424c-0.033,0.339-1.538,13.592,0.83,11.949c-8.074,5.597-11.444,9.24-3.147,18.487c0.057-0.018,0.109-0.025,0.161-0.021c0.488,0.028,2.225,18.062,1.507,20.461c-1.628,5.45,3.002,3.869,5.252,6.77c3.583,4.622,20.332,29.059,25.81,26.714c2.967-2.051,8.895-33.117,18.361-18.579c8.562,13.147,19.139,18.611,21.22,36.274c0.801,6.795,9.876,15.563,6.98,23.449c0.035,1.069-2.369,3.5-3.36,6.098c-1.579,4.141,0.507,5.626,0.59,8.705c0.077,2.863-1.261,6.379,0.171,7.295c2.729-2.863,4.608-0.712,5.34-1.773c0.73-1.061,2.026-7.241,1.469-8.839c1.018,0,2.689-2.62,3.188-1.574c0.475,0.994-0.29,4.878-1.115,6.172c-0.825,1.293-0.546,5.117-3.308,7.854c-0.669,0.663,1.659,5.125,3.482,7.563c1.902,2.544,2.367,3.169,2.714,12.858c1.724,2.136,5.773,9.032,8.625,9.59c-0.919,4.597,7.311,18.626,8.537,17.398c1.227-1.227-3.891-10.114-4.652-12.522c-0.267-0.844-2.877-6.688,0.572-6.989c0.901-1.75-6.147-8.239-5.975-8.451c-0.425-13.218,4.594-17.397,11.383-19.636c1.071,6.744,1.476,7.184,10.16,6.609c3.102-0.205,0.908,9.619,5.231,7.263C285.773,363.36,289.662,362.727,283.941,352.213z M241.922,330.229c0.419-2.514,1.677-3.771,2.793-2.793c1.117,0.978,0.419,2.793-0.419,3.909C243.459,332.464,241.504,332.742,241.922,330.229z M243.459,335.535c-0.279-1.535,2.403-1.804,2.233-0.558C245.37,337.347,243.737,337.071,243.459,335.535z M237.399,320.622c-2.856,3.112-1.315,11.657-0.744,11.088C237.225,331.14,240.824,316.891,237.399,320.622z M209.396,272.272c1.289-0.946-1.188-9.192-5.512-2.806C203.025,270.737,208.355,273.039,209.396,272.272z M207.968,288.786c0.489,2.26,2.317-0.696,2.317-0.696C209.566,288.218,207.479,286.525,207.968,288.786z"></path>
          
          <!-- Sylhet -->
          <path class="region" id="division-sylhet" onmouseenter="updateMap('Sylhet')" onmouseleave="hideTooltip()" d="M183.185,100.527c-0.106,2.202-2.387,16.735,0.847,17.537c10.98,2.721,10.676,5.82,11.076,12.716c1.616,0.958,3.36,1.55,5.231,1.778c4.059,3.142-4.469,4.026-2.061,7.466c1.544,2.206,0.24,8.441-1.406,7.899c1.012-0.395,1.629,0.186,2.714,0.181c3.831,3.831-2.017,12.736-4.15,14.579h-0.874c6.514,5.556,4.956-1.176,9.889-0.986c-1.912-0.074-4.108,17.784-0.764,20.178c0.167,7.125,4.307-4.638,5.024-7.729c0.718-3.091,10.782,1.351,15.69,0.686c0.735-0.91,3.126-6.645,3.126-6.645l5.481,4.018c0,0-1.631-4.987,1.67-5.667c3.301-0.681,7.404,4.538,7.869,4.933c0.416-1.753,3.075-8.888,3.075-8.888s-3.254-0.43-1.418-3.251c1.837-2.822,3.98,1.594,4.651,1.149c0.669-0.444-1.099-2.881-0.575-3.63c0.523-0.749,5.632-0.622,6.587-0.662c2.64-0.109,2.448-2.359,2.47-3.727c0.015-1.008,0.052-5.925,0.052-5.925s1.595,0.167,2.521-0.666s5.414-14.594,5.51-18.36c0.097-3.765-2.272-6.873-2.664-7.714c1.483-0.19,10.683,3.979,11.279,4.29c1.264,0.655,6.446-2.923,6.19-3.756C261.382,98.005,238.317,99.56,224.059,104c1.046-0.564-13.185-1.958-13.678-2.555c-4.379-5.317-23.231-2.37-28.07-0.917H183.185z"></path>
          
          <!-- Khulna -->
          <path class="region" id="division-khulna" onmouseenter="updateMap('Khulna')" onmouseleave="hideTooltip()" d="M95.131,325.247c0.357,0.33-1.542,5.69,1.515,7.314C97.708,333.127,98.682,329.771,95.131,325.247z M64.371,319.374c0.235-0.035-0.414,12.693,5.486,12.693C67.658,329.543,65.933,320.967,64.371,319.374z M81.347,187.048c-8.523,13.277,4.219,18.069,7.839,28.952c-0.645-1.935,10.521,3.946,5.871,5.087c-3.263,0.8,1.573,9.796,3.015,8.628c-0.817,0.662-1.022,0.735-1.144,1.971c-0.117,1.177,6.253,6.137,6.106,4.552c-1.13,2.737-3.996,0.793-4.09,2.389c1.13,4.573,6.286,10.877,10.509,14.643c3.584,3.198,6.128,5.35,5.629,7.651c-3.295,12.348,3.551,12.665-1.24,22.646c-0.584-1.251-3.624-4.954-4.295-3.946c-0.673,1.008,4.132,6.927,5.601,9.418c-2.031,4.064-0.895,14.249-4.966,20.596c1.078,1.078,6.454,7.755,2.068,14.551c-5.113,0.306-7.111-6.8-4.841-11.576c-3.487,7.078-4.407,11.994-4.407,11.994s-2.102-3.476,2.08-16.275c-2.118,1.676-2.102,7.515-3.931,9.501c-1.371,1.488-2.79-1.778-3.161-0.273c1.669,2.505,2.507,7.619,3.434,11.384c0.973,3.954-5.542-3.953-6.121-5.48c-2.956-7.82,7.027-15.051,1.946-22.014c-1.01-3.038,4.046-7.358,2.853-11.257c-1.965-6.414-2.348-14.867-6.123-18.828c3.449,5.209,1.347,44.326-0.946,41.647c-1.075-1.256-1.361-8.205-2.629-15.427c-1.764-10.03-4.389-20.935-4.389-20.935s1.281,11.226,2.982,20.731c1.235,6.903,2.746,12.767,1.379,13.413c1.485-0.703,2.802,14.028-0.407,8.472c-1.098-1.904-2.951-8.112-1.797-9.266c-2.928,2.935,3.076,13.181,0.036,14.209c2.013-6.17-0.629,5.676-3.005,7.846c-3.439-8.127,0.954-19.964,1.487-28.678c-0.373,0-4.272,2.299-4.061,2.245c0,3.285,2.322,6.467,0.303,9.739c-1.669-5.793-3.122-6.077-2.084-14.7c-4.84,10.498,5.065,12.922-0.692,22.945c0.111,1.375-2.11-8.616-5.208-16.277c-0.65,3.63-0.028,5.727,1.041,7.806c1.823,8.581,5.736,13.802,1.955,20.994c-2.901-2.106-4.645-10.284-3.053-15.783c0.328-1.13-2.923-2.171-3.633-2.733c-0.32-1.281,2.448-5.728,2.763-4.012c-0.054-0.303-5.214-7.851-5.069-7.939c-0.167,0.103,2.443,4.67,1.419,6.498c0.527,4.271-3.047,6.803,2.967,8.303c0.209,0.839-0.855,7.197-1.7,7.328c-6.021,0.924-5.266-19.495-5.682-22.135c2.604-3.91-5.733-8.478-4.325-10.985c0.521-0.925,2.544-39.057-7.434-43.163c-1.254-1.113,0.287-14.078,6.734-17.981c-5.506-0.208-15.784,0.413-17.347-5.4c-0.333-1.231,10.386-14.113,3.064-12.221c-12.175,3.15-9.011-23.785-10.367-25.145c8.013,8.037,10.061-19.151,10.061-19.151c8.251,4.276,12.695,0.993,17.88,8.422C67.214,188.097,74.725,184.959,81.347,187.048z"></path>
        </svg>
      </div>

      <!-- Data Panel -->
      <div class="data-panel" id="dataPanel">
        <div class="panel-header" id="pTitle">Dhaka Division</div>
        <div class="panel-sub">Central Industrial Zone</div>
        
        <div class="stat-row">
          <span class="stat-label"><span class="indicator-dot" style="background: var(--energy-color);"></span>Energy Demand</span>
          <span class="stat-val" id="pEnergy">Critical</span>
        </div>
        <div class="stat-row">
          <span class="stat-label"><span class="indicator-dot" style="background: var(--water-color);"></span>River Pollution</span>
          <span class="stat-val" id="pWater">Severe (Buriganga)</span>
        </div>
        <div class="stat-row">
          <span class="stat-label"><span class="indicator-dot" style="background: var(--soil-color);"></span>Arable Soil</span>
          <span class="stat-val" id="pSoil">Diminishing</span>
        </div>
        <div class="stat-row" style="border: none;">
          <span class="stat-label">Recommended Tech</span>
          <span class="stat-val" id="pTech" style="color: var(--energy-color);">HAYTHAM X ONE</span>
        </div>
      </div>
    </div>
  </section>

  <footer>
    <p style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 1.5rem;">© 2025 Integrated Research Portfolio • A Razin Saleh Production</p>
    <div style="display: flex; gap: 2rem; justify-content: center; font-size: 1.5rem;">
      <a href="#" style="color: var(--text-muted); transition: color 0.3s;" onmouseover="this.style.color='white'" onmouseout="this.style.color='#94a3b8'"><i class="fa-brands fa-github"></i></a>
      <a href="#" style="color: var(--text-muted); transition: color 0.3s;" onmouseover="this.style.color='white'" onmouseout="this.style.color='#94a3b8'"><i class="fa-brands fa-linkedin"></i></a>
      <a href="#" style="color: var(--text-muted); transition: color 0.3s;" onmouseover="this.style.color='white'" onmouseout="this.style.color='#94a3b8'"><i class="fa-solid fa-envelope"></i></a>
    </div>
    <div class="visitor-count" id="visitor-display">
      <!-- Counter will appear here -->
    </div>
  </footer>

  <!-- AI CHAT MODAL (Triggered by Hero Search) -->
  <div class="ai-chat-modal" id="ai-modal">
    <div class="chat-header">
      <h3><i class="fa-solid fa-robot"></i> Nexus AI Assistant</h3>
      <button onclick="toggleAI()" style="background:none; border:none; color:white; cursor:pointer;"><i class="fa-solid fa-xmark"></i></button>
    </div>
    <div class="chat-body" id="chat-body">
      <div class="message ai">
        Hello! I am the Nexus AI. I know everything about Razin's research on Soil, Water, and Energy. How can I help you today?
      </div>
    </div>
    <div class="suggestions">
      <span class="suggestion-chip" onclick="askAI('Tell me about Project WATER')">Project WATER?</span>
      <span class="suggestion-chip" onclick="askAI('How does Smart Agriculture work?')">Smart Agri?</span>
      <span class="suggestion-chip" onclick="askAI('What is HAYTHAM X ONE?')">HAYTHAM Energy?</span>
    </div>
    <div class="chat-input-area">
      <input type="text" id="ai-input" class="chat-input" placeholder="Ask about the research..." onkeypress="handleEnter(event)">
      <button class="send-btn" onclick="sendUserMessage()"><i class="fa-solid fa-paper-plane"></i></button>
    </div>
  </div>

  <script>
    // Parallax on Mouse Move
    document.addEventListener('mousemove', (e) => {
      const orbs = document.querySelectorAll('.orb');
      const x = e.clientX / window.innerWidth;
      const y = e.clientY / window.innerHeight;

      orbs.forEach((orb, index) => {
        const speed = (index + 1) * 15;
        orb.style.transform = `translate(${x * speed}px, ${y * speed}px)`;
      });
    });

    // Scroll Progress Bar
    window.onscroll = function() {
      let winScroll = document.body.scrollTop || document.documentElement.scrollTop;
      let height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      let scrolled = (winScroll / height) * 100;
      document.querySelector(".scroll-progress").style.width = scrolled + "%";
    };

    // Mobile Menu Toggle
    const menuToggle = document.querySelector('.menu-toggle');
    const navLinks = document.querySelector('.nav-links');

    menuToggle.addEventListener('click', () => {
      const isVisible = navLinks.style.display === 'flex';
      navLinks.style.display = isVisible ? 'none' : 'flex';
      if (!isVisible) {
        navLinks.style.position = 'absolute';
        navLinks.style.top = '100%';
        navLinks.style.left = '0';
        navLinks.style.width = '100%';
        navLinks.style.background = '#020617';
        navLinks.style.flexDirection = 'column';
        navLinks.style.padding = '2rem';
        navLinks.style.borderBottom = '1px solid rgba(255,255,255,0.1)';
      }
    });

    // Tooltip Logic
    const tooltip = document.getElementById('map-tooltip');
    
    document.addEventListener('mousemove', (e) => {
      if (tooltip.style.opacity === '1') {
        tooltip.style.left = e.clientX + 'px';
        tooltip.style.top = e.clientY + 'px';
      }
    });

    function hideTooltip() {
      tooltip.style.opacity = '0';
    }

    // Map Data & Interaction
    const divisionData = {
      'Dhaka': { sub: 'Central Industrial Zone', energy: 'Critical Demand', water: 'Severe Pollution', soil: 'Diminishing', tech: 'HAYTHAM X ONE' },
      'Chittagong': { sub: 'Port & Coastal Zone', energy: 'High Solar Potential', water: 'Marine Waste Risk', soil: 'Hilly Terrain', tech: 'Project W.A.T.E.R.' },
      'Rajshahi': { sub: 'North-West Drought Zone', energy: 'High Irradiance', water: 'River Drying', soil: 'Fertile/Dry', tech: 'Smart Agriculture' },
      'Khulna': { sub: 'Mangrove Coastal Zone', energy: 'Moderate', water: 'Salinity Intrusion', soil: 'Saline', tech: 'Project W.A.T.E.R.' },
      'Sylhet': { sub: 'North-East Hills', energy: 'Hydro Potential', water: 'Flash Floods', soil: 'Tea Plantations', tech: 'Smart Agriculture' },
      'Barisal': { sub: 'Southern Riverine', energy: 'Tidal Potential', water: 'River Erosion', soil: 'Alluvial', tech: 'Smart Agriculture' },
      'Rangpur': { sub: 'Northern Agrarian', energy: 'Solar Potential', water: 'Teesta Flow', soil: 'Highly Fertile', tech: 'Smart Agriculture' },
      'Mymensingh': { sub: 'Central North', energy: 'Biomass Potential', water: 'Moderate', soil: 'Fertile', tech: 'Smart Agriculture' }
    };

    function updateMap(divName) {
      const data = divisionData[divName];
      if(!data) return;

      // Update Tooltip
      tooltip.innerHTML = `<h4>${divName}</h4><p>${data.sub}</p>`;
      tooltip.style.opacity = '1';

      // Update Panel Text
      document.getElementById('pTitle').innerText = divName + ' Division';
      document.querySelector('.panel-sub').innerText = data.sub;
      document.getElementById('pEnergy').innerText = data.energy;
      document.getElementById('pWater').innerText = data.water;
      document.getElementById('pSoil').innerText = data.soil;
      document.getElementById('pTech').innerText = data.tech;

      // Update Region Styling
      document.querySelectorAll('.region').forEach(node => node.classList.remove('active'));
      const activeRegion = document.getElementById(`division-${divName.toLowerCase()}`);
      if(activeRegion) activeRegion.classList.add('active');
    }

    // --- AI Chat Logic ---
    const modal = document.getElementById('ai-modal');
    const input = document.getElementById('ai-input');
    const heroInput = document.getElementById('hero-input');
    const chatBody = document.getElementById('chat-body');

    // !!! GEMINI API KEY PLACEHOLDER !!!
    // Note: You must insert your Gemini API Key here if you haven't already.
    // The Firebase keys below are for database/tracking only.
    const GEMINI_API_KEY = "AIzaSyBWT1_fjtG8YCDm8a6gL3fgKiznyTClk-Y"; 

    const SYSTEM_PROMPT = `
    You are Nexus AI, an assistant for Razin Saleh's research portfolio.
    Answer questions concisely based on this data:
    
    1. Project: Smart Agriculture (Soil Theme)
       - Tech: IoT Network, Robotics, AI.
       - Goal: Precision farming ecosystem. Integrates real-time soil chemical sensing, automated pest control, and micro-climate modeling to maximize crop yield.
       - Key Area: Rajshahi, Rangpur, Sylhet.

    2. Project: Project W.A.T.E.R. (Water Theme)
       - Tech: Restoration, Autonomous, Circular Economy.
       - Goal: Theoretical framework using autonomous bubble barriers to intercept transboundary pollution. Upcycles river waste into clean energy/materials.
       - Key Area: Chittagong, Khulna (Salinity/Marine Waste).

    3. Project: HAYTHAM X ONE (Energy Theme)
       - Tech: CSP, Hydrogen, Thermal Storage.
       - Goal: Reliable energy nexus. Combines Concentrating Solar Power (CSP) with thermal sand storage and hydrogen fuel cells for 24/7 grid electricity.
       - Key Area: Dhaka (Critical Demand).

    4. Map Data:
       - Dhaka: Industrial Zone, Needs Energy.
       - Chittagong: Coastal, Needs Water Cleanup.
       - Rajshahi: Drought Zone, Needs Smart Agri.
       - Khulna: Mangrove/Saline, Needs Water Tech.

    5. About Razin Saleh (Lead Contributor):
       - Profile: 20-year-old innovator exploring history, technology, and creativity.
       - Education/Leadership: Former House Prefect (Tariq House) at Rajshahi Cadet College (led 103 cadets). Developed discipline and calm leadership under pressure.
       - Focus: Smart agriculture, renewable energy, and environmental solutions. Lead contributor on all 3 listed projects.
       - Hobbies: Graphics designing, debating, running, watching movies.
       - Philosophy: Simple living, positive thinking, and continuous learning.

    Keep answers short (under 3 sentences) and professional yet futuristic.
    `;

    function toggleAI() {
      modal.classList.toggle('open');
      if(modal.classList.contains('open')) {
        input.focus();
      }
    }

    function handleEnter(e) {
      if (e.key === 'Enter') sendUserMessage();
    }

    // Hero Search Logic
    function handleHeroEnter(e) {
      if (e.key === 'Enter') sendHeroMessage();
    }

    function sendHeroMessage() {
        const text = heroInput.value.trim();
        if (!text) {
            // Just open modal if empty
            toggleAI();
            return;
        }
        
        // Open modal
        modal.classList.add('open');
        
        // Pass text to internal input and send
        input.value = text;
        heroInput.value = ''; // Clear hero input
        sendUserMessage();
    }

    function askAI(question) {
      input.value = question;
      sendUserMessage();
    }

    function appendMessage(text, sender) {
      const div = document.createElement('div');
      div.className = `message ${sender}`;
      div.innerText = text;
      chatBody.appendChild(div);
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    function showTyping() {
      const div = document.createElement('div');
      div.className = 'message ai typing-indicator';
      div.id = 'typing';
      div.innerHTML = '<div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>';
      chatBody.appendChild(div);
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    function removeTyping() {
      const typing = document.getElementById('typing');
      if(typing) typing.remove();
    }

    async function sendUserMessage() {
      const text = input.value.trim();
      if (!text) return;

      appendMessage(text, 'user');
      input.value = '';
      showTyping();

      try {
        if (!GEMINI_API_KEY) {
          removeTyping();
          appendMessage("Error: Gemini API Key missing in code.", "ai");
          return;
        }

        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${GEMINI_API_KEY}`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{
              parts: [{ text: SYSTEM_PROMPT + "\nUser Question: " + text }]
            }]
          })
        });

        const data = await response.json();
        removeTyping();

        if (data.candidates && data.candidates[0].content) {
          const reply = data.candidates[0].content.parts[0].text;
          appendMessage(reply, 'ai');
        } else {
          appendMessage("I'm having trouble connecting to the Nexus database.", 'ai');
        }

      } catch (error) {
        removeTyping();
        console.error(error);
        appendMessage("System Error. Please try again.", 'ai');
      }
    }
  </script>

  <!-- Firebase Realtime DB & Enhanced Tracker -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, get, runTransaction, push, update, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    // --- INTEGRATED FIREBASE CONFIG ---
    const firebaseConfig = {
      apiKey: "AIzaSyDZvetMzQc0K-9Vyx8oMdgPy749e2iZKMI",
      authDomain: "nexus-portfolio-551a1.firebaseapp.com",
      databaseURL: "https://nexus-portfolio-551a1-default-rtdb.firebaseio.com",
      projectId: "nexus-portfolio-551a1",
      storageBucket: "nexus-portfolio-551a1.firebasestorage.app",
      messagingSenderId: "677212397246",
      appId: "1:677212397246:web:5e828eaa216fa9341788ef"
    };
    // ---------------------------------------

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // Helper to parse Operator, Browser, and Device
    function getSystemInfo() {
      const ua = navigator.userAgent;
      let browser = "Unknown";
      let device = "Desktop";

      // Browser Detection
      if (ua.indexOf("Firefox") > -1) browser = "Firefox";
      else if (ua.indexOf("SamsungBrowser") > -1) browser = "Samsung Internet";
      else if (ua.indexOf("Opera") > -1 || ua.indexOf("OPR") > -1) browser = "Opera";
      else if (ua.indexOf("Trident") > -1) browser = "Internet Explorer";
      else if (ua.indexOf("Edge") > -1) browser = "Edge";
      else if (ua.indexOf("Chrome") > -1) browser = "Chrome";
      else if (ua.indexOf("Safari") > -1) browser = "Safari";

      // Device Detection
      if (/Android/i.test(ua)) device = "Android Mobile";
      else if (/iPhone/i.test(ua)) device = "iPhone";
      else if (/iPad/i.test(ua)) device = "iPad";
      else if (/Linux/i.test(ua)) device = "Linux Desktop";
      else if (/Macintosh/i.test(ua)) device = "Mac";
      else if (/Windows/i.test(ua)) device = "Windows PC";

      return { browser, device };
    }

    async function trackVisitor() {
      // 1. References
      const counterRef = ref(db, 'stats/general/total_visits');
      const visitsRef = ref(db, 'visits');

      // 2. Check Session
      const hasVisited = sessionStorage.getItem("hasVisited");
      let currentVisitId = sessionStorage.getItem("currentVisitId");

      if (!hasVisited) {
        // Increment global counter
        runTransaction(counterRef, (currentCount) => {
          return (currentCount || 0) + 1;
        });

        // Fetch IP Data (including ISP/Org)
        let ipData = {};
        try {
          const response = await fetch('https://ipwho.is/');
          ipData = await response.json();
        } catch (error) {
          console.log("IP Fetch failed", error);
          ipData = { ip: 'Unknown', city: 'Unknown', country: 'Unknown', connection: { isp: 'Unknown' } };
        }

        // Get System Info
        const sysInfo = getSystemInfo();

        // Create new visit record
        const newVisitRef = push(visitsRef);
        currentVisitId = newVisitRef.key;
        sessionStorage.setItem("currentVisitId", currentVisitId);

        await update(newVisitRef, {
          timestamp: serverTimestamp(),
          page: window.location.pathname,
          ip: ipData.ip || 'Unknown',
          city: ipData.city || 'Unknown',
          country: ipData.country || 'Unknown',
          flag: ipData.flag ? ipData.flag.img : '',
          isp: ipData.connection ? (ipData.connection.isp || ipData.connection.org) : 'Unknown', // Network Operator
          device: sysInfo.device,
          browser: sysInfo.browser,
          userAgent: navigator.userAgent, // Keep raw just in case
          timeSpent: 0 
        });

        sessionStorage.setItem("hasVisited", "true");
      }

      // 3. Heartbeat: Update time spent every 5 seconds
      if (currentVisitId) {
        const visitPath = `visits/${currentVisitId}`;
        let timeSpent = 0;
        
        setInterval(() => {
          timeSpent += 5;
          update(ref(db, visitPath), {
            timeSpent: timeSpent
          });
        }, 5000); 
      }

      // 4. Display Counter
      try {
        const snapshot = await get(counterRef);
        if (snapshot.exists()) {
          document.getElementById('visitor-display').innerText = `Total Views: ${snapshot.val()}`;
        }
      } catch (e) {
        console.error("Counter error", e);
      }
    }

    trackVisitor();
  </script>

</body>
</html>

